# メール（作業に関連する部分の抜粋）

## 2023/03/31 09:02

[以下のフォルダ](2023-03-31.zip)に、修正した仕様書、修正したpythonコード、修正した入力ファイル、アルゴリズムの変更点概要を記載したスライドを置きました。
addBandsFrom4Bands()はこのコードの中で使ってませんが、テストしています。
この関数ですが、現状の仕様だと時間がかかる場合、しきい値が大きい場合に、時間がかかっても何も出てこない場合があります。
よろしくお願いいたします。

## 2023/03/23 16:30

なし

## 2023/03/23 12:32

私の方で[仕様書](R5_仕様書.docx)を作成しましたので、ご確認ください。[label](../tmp/2023-03-31/mask.py)
自宅のwindows 10のPCでも同様のエラーは出ました。

少しコードの背景を説明しますと、本ソフトウェアで、
高対称性の結晶格子に対してはバンドエッジ抽出→indexingの自動化ができていることは確認できたのですが、
triclinic, monoclinic等の低対称性のものについては微妙です。
EBSDコミュニティは出来る出来ると当然主張してきているわけですが
（しかし今のところどのグループも低対称性の場合の自動化はできてないはずです）、
CONOGRAPHのindexingコードが出している格子定数の誤差の値をみると、
バンドの角度にして0.1 degreeの精度が必要である可能性があります。
自動抽出だけでそこまでの精度が出るとも思えませんから、
GUI上での手作業でどこまで状況を改善できるか、
という点が話の味噌になり、そのため今回のバグ修正が必要になっています。

## 2023/03/15 16:24

先日お送りした件の補足ですが、
windows10でも起きるかどうかはまだ確認できてないのですが
（今日試したPCは6年前に購入したもので
それ以前の問題としてランタイムを入れるところで引っかかってしまったため、
帰宅してからまたやろうかと思います）、
以下の1.は１度目の解析からですが、
2.が生じるのは２回目の解析からです。

1. sigma系が全部90度になる
2. バンドセンターや数字が表示されない

## 2023/03/13 11:59

先日使おうとしてみたところ、以下のような状況で使うことができませんでした。
（PCのOSがwindows 11にバージョンアップされたからかもしれません。
今できないのですが、Windows10で後で試験してみようとは思っています。）

- バンドセンターが表示されない
- バンドに対応する数字が左上済に重なって表示されており見えない
  （このため、リストにあるバンドと画像バンドの対応がよく分からない）
- indexing用に出力しているファイルのsigma系が全て90度で出力される。

その他、最近pythonコードで用いている座標系を中心とするチェックを行っており、
この座標系に関係するバグがあったと思われます。
（添付ファイルに最近行った変更点に関する項目をまとめており、
この座標系の話についても記載しています。
バンド抽出そのものへの影響は非常に軽微なものだったと思われますが、
その後にバンドを追加するところでも関係があったかもしれません。）

この際、pythonコードについても置き換えて頂けると大変助かります。
（[添付ファイル](コードの変更点.docx)記載のバグ修正の他、
中身のアルゴリズムが改善されています。
全体的な変更点は添付のwordファイルにまとめていますが、
関数名・引数等の変更はほとんどなく、よろしければ、
変更状況が分かるように現状のpythonコード等をまた後でお送りいたします。）
